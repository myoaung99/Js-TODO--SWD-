<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Js TODO List</title>
  </head>
  <body>
    <input type="text" id="input" autofocus />
    <button id="clear">Clear Storage</button>
    <br />
    <ul id="list"></ul>
    <script>
      let input = document.querySelector("#input");
      let list = document.querySelector("#list");
      // const clear = document.querySelector("#clear");

      const keys = Object.keys(localStorage);
      keys.sort();

      let id = 1;

      // id á€”á€¶á€•á€«á€á€ºá€€á€­á€¯ á€¡á€…á€¥á€ºá€œá€­á€¯á€€á€ºá€žá€½á€¬á€¸á€–á€­á€¯á€· á€œá€­á€¯á€á€»á€„á€ºá€á€¬
      if (localStorage.length > 0) {
        id = Number(keys[keys.length - 1]) + 1;
      }

      clear.addEventListener("click", () => {
        console.log("Clear");
        localStorage.clear();
        list.innerHTML = "";
      });

      // local Storage á€™á€¾á€¬ á€žá€­á€™á€ºá€¸á€á€¼á€„á€ºá€¸
      function saveToLocalStorage(item) {
        localStorage.setItem(id, item);
        id += 1;
        input.value = "";
      }

      // á€–á€»á€€á€ºá€žá€Šá€·á€º function
      function del(x) {
        localStorage.removeItem(x);
        let current = document.getElementById(x);
        current.remove();
      }

      // Item á€€á€­á€¯ edit á€á€¼á€„á€ºá€¸
      function edit(x) {
        let current = document.getElementById(x);
        let originalItem = current.childNodes[2].nodeValue;
        let editItem = prompt("Edit ðŸ‘‰ " + originalItem);

        localStorage.setItem(x, editItem);
        current.childNodes[2].nodeValue = " - " + editItem;
      }

      // id(key) á€”á€²á€· item(localstorage.value)á€á€½á€± á€œá€€á€ºá€á€¶á€•á€¼á€®á€¸ li á€á€½á€±áŠ btná€á€½á€± á€á€Šá€ºá€†á€±á€¬á€€á€º
      function addToList(item, y) {
        const li = document.createElement("li");

        // Delete Button
        let delbtn = document.createElement("button");
        let delText = document.createTextNode("Delete");
        delbtn.setAttribute("onclick", "del(" + y + ")");
        delbtn.appendChild(delText);

        // Edit button
        let editbtn = document.createElement("button");
        let editText = document.createTextNode("Edit");
        editbtn.setAttribute("onclick", "edit(" + y + ")");
        editbtn.appendChild(editText);

        li.setAttribute("id", y);
        li.append(delbtn);
        li.append(editbtn);
        li.append(" - " + item);
        list.append(li);
      }

      // ul á€‘á€²á€€á€­á€¯ á€žá€½á€¬á€¸á€‘á€Šá€·á€º
      function showFromLocalStorage() {
        keys.map((el) => {
          addToList(localStorage.getItem(el), el);
        });
      }

      // input á€€á€­á€¯á€…á€±á€¬á€„á€·á€º
      input.addEventListener("keyup", function (e) {
        if (e.code === "Enter") {
          addToList(this.value);
          saveToLocalStorage(this.value);
          location.reload();
        }
      });

      showFromLocalStorage();
    </script>
  </body>
</html>
